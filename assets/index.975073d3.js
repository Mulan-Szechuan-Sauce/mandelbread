import{S as n,i as e,s as o,e as t,a,t as r,c as i,b as c,d as m,f as s,g as f,h as l,j as h,k as d,l as u,m as g,n as v,o as y,p as x,q as p}from"./vendor.15fcb96d.js";const{window:_}=x;function b(n){let e,o,y,x,p,b,S,E,F,R;return{c(){e=t("main"),o=t("canvas"),y=a(),x=t("div"),p=r(n[1]),b=a(),S=t("div"),E=r(n[2]),this.h()},l(t){e=i(t,"MAIN",{});var a=c(e);o=i(a,"CANVAS",{width:!0,height:!0}),c(o).forEach(m),y=s(a),x=i(a,"DIV",{});var r=c(x);p=f(r,n[1]),r.forEach(m),b=s(a),S=i(a,"DIV",{});var l=c(S);E=f(l,n[2]),l.forEach(m),a.forEach(m),this.h()},h(){l(o,"width",A),l(o,"height",w)},m(t,a){h(t,e,a),d(e,o),n[4](o),d(e,y),d(e,x),d(x,p),d(e,b),d(e,S),d(S,E),F||(R=u(_,"keydown",n[3]),F=!0)},p(n,[e]){2&e&&g(p,n[1]),4&e&&g(E,n[2])},i:v,o:v,d(o){o&&m(e),n[4](null),F=!1,R()}}}const A=1e3,w=1e3;function S(n,e,o){let t,a=-.7436441,r=.1318255,i=2;const c=(n,e)=>({x:n.x+e.x,y:n.y+e.y}),m=(n,e)=>({x:n.x*e.x-n.y*e.y,y:n.x*e.y+n.y*e.x}),s=(n,e)=>n.x*e.x+n.y*e.y;y((()=>{const n=t.getContext("webgl"),e=(n=>{if(null===n)return void alert("Unable to initialize WebGL. Your browser or machine may not support it.");const e=n.createProgram();var o=n.createShader(n.VERTEX_SHADER);n.shaderSource(o,"attribute vec4 a_position;\n\nvoid main() {\n  gl_Position = a_position;\n}\n"),n.compileShader(o),n.attachShader(e,o);var t=n.createShader(n.FRAGMENT_SHADER);if(n.shaderSource(t,'precision highp float;\n\nuniform float cx;\nuniform float cy;\nuniform float width;\nuniform float height;\nuniform float zoom_amount;\n\nvec2 imagine_multiplying(vec2 a, vec2 b) {\n  return vec2(a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x);\n}\n\nvec3 mandelbrot_perturbation(vec2 c, vec2 dc) {\n    vec2 z = vec2(0.0);\n    vec2 dz = vec2(0.0);\n    float n = -1.0;\n\n    for (int i=0; i < 10000; i++) {\n        dz = imagine_multiplying(2.0 * z + dz, dz) + dc;\n        z  = imagine_multiplying(z, z) + c;\n        \n        if (sqrt(dot(dz, dz)) > 50000000000.0) {\n          n = float(i);\n          break;\n        }\n    }\n\n    if (n < 0.0)\n      // FIXME: Something wacky going on with "in-set" pixels for some cx, cy values\n      return vec3(0.0);\n\n    return 0.5 + 0.5 * cos(pow(zoom_amount, 0.22) * n * 0.05 + vec3(3.0, 3.5, 4.0));\n}\n\nvoid main() {\n    float maxDim = max(width, height);\n    vec2 p = 2.0 * vec2(gl_FragCoord.x / maxDim, gl_FragCoord.y / maxDim) - vec2(width / maxDim, height / maxDim);\n\n    vec2 c = vec2(cx, cy);\n\n    //c = vec2(-1.1900443, 0.3043895);\n    //c = vec2(-0.7436441,0.1318255);\n\n    vec2 dc = p * zoom_amount;\n    vec3 color = mandelbrot_perturbation(c, dc);\n    \n    gl_FragColor = vec4(color, 1.0);\n}\n'),n.compileShader(t),n.attachShader(e,t),[o,t].map((e=>{if(!n.getShaderParameter(e,n.COMPILE_STATUS))throw"Could not compile WebGL program. \n\n"+n.getShaderInfoLog(e)})),n.linkProgram(e),!n.getProgramParameter(e,n.LINK_STATUS))throw"Could not compile WebGL program. \n\n"+n.getProgramInfoLog(e);const a=n.getAttribLocation(e,"a_position"),r=n.createBuffer();return n.bindBuffer(n.ARRAY_BUFFER,r),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),n.STATIC_DRAW),n.viewport(0,0,n.canvas.width,n.canvas.height),n.useProgram(e),n.enableVertexAttribArray(a),n.bindBuffer(n.ARRAY_BUFFER,r),n.vertexAttribPointer(a,2,n.FLOAT,!1,0,0),e})(n),o=n.getUniformLocation(e,"cx"),f=n.getUniformLocation(e,"cy"),l=n.getUniformLocation(e,"width"),h=n.getUniformLocation(e,"height"),d=n.getUniformLocation(e,"zoom_amount");n.uniform1f(l,A),n.uniform1f(h,w);const u=e=>{n.uniform1f(o,a),n.uniform1f(f,r),n.uniform1f(d,i),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),n.drawArrays(n.TRIANGLES,0,6),window.requestAnimationFrame(u)};console.log(((n,e)=>{let o={x:0,y:0},t={x:0,y:0};for(let i=0;i<60;i++)if(t=c(m(c({x:(a=2)*(r=o).x,y:a*r.y},t),t),e),o=c(m(o,o),n),s(t,t)>4)return!1;var a,r;return console.log("final z:",o,t),!0})({x:-.7436441,y:.1318255},{x:.5,y:.5})),window.requestAnimationFrame(u)}));return[t,a,r,n=>{"+"==n.key?i*=.95:"-"==n.key?i/=.95:"h"==n.key?o(1,a-=.01*i):"j"==n.key?o(2,r-=.01*i):"k"==n.key?o(2,r+=.01*i):"l"==n.key&&o(1,a+=.01*i)},function(n){p[n?"unshift":"push"]((()=>{t=n,o(0,t)}))}]}new class extends n{constructor(n){super(),e(this,n,S,b,o,{})}}({target:document.getElementById("app")});
